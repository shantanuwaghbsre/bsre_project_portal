<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quotation Details</title>
    <style>

        body {
            font-family: Helvetica;
        }

        .main_title{
            color: black;
            text-align: center;
            font-size: 55px;
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 20px;
            text-decoration: underline;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table, th, td {
            /* border: 0.1px solid rgb(78, 78, 78); */
        }
      
        th, td {
            padding: 8px;
            text-align: left;
        }

        h3{
            font-size: 40px;
            font-weight: bold;
            color: black;
            margin-top: 100px;
            margin-bottom: 40px;
        }

        th {
            /* background-color: #f2f2f2; */
            background-color: #ffdd00;
            padding-top: 25px;
            padding-bottom: 25px;
            text-align: left;
            font-size: 35px;
            font-weight: semibold;
            color: black;

        }

        td{
            font-size: 30px;
            font-weight: normal;
            color: black;
            padding-top: 15px;
            padding-bottom: 15px;


        }

        /* tr:nth-child(even){background-color: #fffac3;} */
        tr:nth-child(even){background-color: #f2f2f2;}
        .next-page {
        page-break-before: always;
        }

        ol {
        list-style-type: number;
        }

        ul {
        list-style-type: square;
        }

    </style>
</head>
<body>
    <h2 class="main_title">Quotation Details</h2>

    <h3>Consumer Details</h3>
    <table>
        <tr>
            <th>Field</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>location</td>
            <td>{{ location }}</td>
        </tr>
        <tr>
            <td>Quotation Type</td>
            <td>{{ quotation_type }}</td>
        </tr>
        <tr>
            <td>Agent Code</td>
            <td>{{ agent_code }}</td>
        </tr>
        <tr>
            <td>Agent Name</td>
            <td>{{ agent_name }}</td>
        </tr>
        <tr>
            <td>Consumer Name</td>
            <td>{{ consumer_name }}</td>
        </tr>
        <tr>
            <td>Consumer Address</td>
            <td>{{ consumer_address }}</td>
        </tr>
        <tr>
            <td>Consumer Mobile Number</td>
            <td>{{ consumer_mobile_number }}</td>
        </tr>
        <tr>
            <td>Consumer Email</td>
            <td>{{ consumer_email }}</td>
        </tr>
    </table>

    <h3>Solar Panel Details</h3>
    <table>
        <tr>
            <th>Field</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Solar Module Name</td>
            <td>{{ solar_module_name }}</td>
        </tr>
        <tr>
            <td>Solar Panel Type</td>
            <td>{{ solar_panel_type }}</td>
        </tr>
        <tr>
            <td>Number of Panels</td>
            <td>{{ number_of_panels }}</td>
        </tr>
        <tr>
            <td>Solar Module Wattage</td>
            <td>{{ solar_module_wattage }}</td>
        </tr>
        <tr>
            <td>Total Kilowatts</td>
            <td>{{ total_kilowatts }}</td>
        </tr>
        <tr>
            <td>Solar Inverter Make</td>
            <td>{{ solar_inverter_make }}</td>
        </tr>
        <tr>
            <td>Number of Inverters</td>
            <td>{{ number_of_inverters }}</td>
        </tr>
        <tr>
            <td>Solar Structure</td>
            <td>{{ solar_structure }}</td>
        </tr>
        

    </table>
    <p class="next-page"></p>
    <h3>Inverter and System Details</h3>
    <table>
        <tr>
            <th>Field</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Grid Tie Inverter Make</td>
            <td>{{ grid_tie_inverter_make }}</td>
        </tr>
        <tr>
            <td>Number of Grid Tie Inverters</td>
            <td>{{ number_of_grid_tie_inverters }}</td>
        </tr>
        <tr>
            <td>Solar Cable</td>
            <td>{{ solar_cable }}</td>
        </tr>
        <tr>
            <td>Switch and Gear Protection Make</td>
            <td>{{ switch_and_gear_protection_make }}</td>
        </tr>
        <tr>
            <td>Sprinkler Installation</td>
            <td>{{ sprinkler_installation }}</td>
        </tr>
    </table>

    <h3>Calculation Details</h3>
    <table>
        <tr>
            <th>Field</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Rate per Watt</td>
            <td>{{ rate_per_watt }}</td>
        </tr>
        <tr>
            <td>GST per Watt</td>
            <td>{{ gst_per_watt }}</td>
        </tr>
        <tr>
            <td>Electricity Unit Rate</td>
            <td>{{ electricity_unit_rate }}</td>
        </tr>
        <tr>
            <td>Inflation in Unit Rate</td>
            <td>{{ inflation_in_unit_rate }}</td>
        </tr>
        <tr>
            <td>Reinvestment Rate</td>
            <td>{{ reinvestment_rate }}</td>
        </tr>
        <tr>
            <td>Any Extra Cost on Add-On Work</td>
            <td>{{ any_extra_cost_on_add_on_work }}</td>
        </tr>
        <tr>
            <td>GST on Add-On Work</td>
            <td>{{ gst_on_add_on_work }}</td>
        </tr>
        <tr>
            <td>Total add-on amount</td>
            <td>{{ "%.2f"|format(any_extra_cost_on_add_on_work + gst_on_add_on_work) }}</td>
        </tr>
        <tr>
            <td>Is Loan?</td>
            <td>{{ is_loan }}</td>
        </tr>
        {% if is_loan %}
        <tr>
            <td>Loan Amount on Project</td>
            <td>{{ loan_amount_on_project }}</td>
        </tr>
        <tr>
            <td>Interest Rate on Loan</td>
            <td>{{ interest_rate_on_loan }}</td>
        </tr>
        <tr>
            <td>Loan Term</td>
            <td>{{ loan_term }}</td>
        </tr>
        <tr>
            <td>Installment of Loan per Month</td>
            <td>{{ installment_of_loan_per_month }}</td>
        </tr>
        {% endif %}
        <tr>
            <td>Total add-on amount</td>
            <td>{{ "%.2f"|format(any_extra_cost_on_add_on_work + gst_on_add_on_work) }}</td>
        </tr>
        <tr>
            <td>Value of project without Gst</td>
            <td>{{ "%.2f"|format(rate_per_watt * 1000 * total_kilowatts) }}</td>
        </tr>
        <tr>
            <td>Value of project with Gst</td>
            <td>{{ "%.2f"|format((rate_per_watt + gst_per_watt) * 1000 * total_kilowatts) }}</td>
        </tr>
        <tr>
            <td>Final cost of project incl. add-on work</td>
            <td>{{ "%.2f"|format(((rate_per_watt + gst_per_watt) * 1000 * total_kilowatts) + (any_extra_cost_on_add_on_work + gst_on_add_on_work)) }}</td>
        </tr>        
        <tr>
            <td>Is Subsidy?</td>
            <td>{{ is_subsidy }}</td>
        </tr>
        {% if is_subsidy %}
        <tr>
            <td>Subsidy per Watt</td>
            <td>{{ subsidy_per_watt }}</td>
        </tr>
        <tr>
            <td>Total value of project after subsidy</td>
            <td>{{ "%.2f"|format(((rate_per_watt + gst_per_watt) * 1000 * total_kilowatts) - 
                (subsidy_per_watt * 1000 * total_kilowatts) + 
                (any_extra_cost_on_add_on_work + gst_on_add_on_work)) }}</td>
        </tr>
        {% endif %}
    </table>
    <p class="next-page"></p>
    <img src="{{ GRAPHS_FOLDER }}Industrial_Commercial_Graph_1.png" width="1000" height="600">
    <img src="{{ GRAPHS_FOLDER }}Industrial_Commercial_Graph_2.png" width="1000" height="600">
    <img src="{{ GRAPHS_FOLDER }}Industrial_Commercial_Graph_3.png" width="1000" height="600">
    <p class="next-page"></p>
    <h2>Irradiation tables for location: {{ location }} lat: {{ latitude }}, long: {{ longitude }}</h2>
    <table>
        <thead>
            <tr>
                <th>No.</th>
                <th>Month</th>
                <th>Sun Irradiation in kW/m2/day</th>
                <th>Unit production in kw</th>
                <th>production in Rs.</th>
            </tr>
        </thead>
        <tbody>
            {% for i in range(months | length) %}
            
            <tr>
                <td>{{i+1}}</td>
                <td>{{ months[i] }}</td>
                <td>{{ irradiation_data[i] }}</td>
                <td>{{ monthly_production[i] }}</td>
                <td>{{ monthly_earnings[i] }}</td>
            </tr>
            {% endfor %}
            <tr>
                <td></td>
                <td>Total (per year)</td>
                <td>{{ yearly_irradiation }}</td>
                <td>{{ annual_production }}</td>
                <td>{{ annual_earnings}}</td>
            </tr>
        </tbody>
    </table>
    <p class="next-page"></p>
    <img src="{{ GRAPHS_FOLDER }}Industrial_Commercial_Graph_4.png" width="1000" height="600">
    <img src="{{ GRAPHS_FOLDER }}Industrial_Commercial_Graph_5.png" width="1000" height="600">
    <img src="{{ GRAPHS_FOLDER }}Industrial_Commercial_Graph_6.png" width="1000" height="600">
    <h2>Note: Due to climactic conditions, the above charts can be vary by Â±10%</h2>
    <p class="next-page"></p>
    <h2>Financial Calculations</h2>
    <table>
        <thead>
            <tr>
                <th>No.</th>
                <th>Production in kw</th>
                <th>Cash flow</th>
                <th>Break even point</th>
                <th></th>
                <th>Reinvestment amount</th>
                <th>Interest rate</th>
                <th>Interest amount</th>
                <th>Final value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>0</td>
                <td></td>
                <td></td>
                <td>{{-total_cost}}</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            {% for i in range(production_degradation | length) %}
            <tr>
                <td>{{i+1}}</td>
                <td>{{ production_degradation[i] }}</td>
                <td>{{ earnings_degradation[i] }}</td>
                <td>{{ breakeven[i] }}</td>
                <td></td>
                <td>{{ earnings_degradation[i] }}</td>
                <td>{{ reinvestment_rate }} %</td>
                <td>{{ (earnings_degradation[i] * reinvestment_rate * 0.01) | round(2) }}</td>
                <td>{{ (earnings_degradation[i] + (earnings_degradation[i] * reinvestment_rate * 0.01)) | round(2) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <p class="next-page"></p>
    <h1>TERMS & CONDITIONS</h1>
    <div>
        <ol>
            <li>If any additional structure work require that will charge Extra.</li>
            <li>Customer can do payment via NEFT/ RTGS or cheque.</li>
            <li>Payment Terms: 100% advance with Order.</li>
            <li>13.8% GST Inclusive in prices Solar.</li>
            <li>GEDA application fees paid by customer Rs. 15,340/- in favourable "Bap Sitaram Renewable Energy"</li>
            <li>GEB Meter Charges Extra as per GEB estimate.</li>
            <li>Scope of Client:</li>
            <ul>
            <li>The Shadow free area for installation of SPV Module on the rooftop.</li>
            <li>Permission for structure fitting with anchor fastening and grouting on the terrace and wall.</li>
            <li>Provide safe space for earthing without any underground piping or cabling. In case the entire compound is paved, the client has to make opening for earthing at a specified space.</li>
            <li>Net Metering Inter Connection Agreement Franking of  Rs. 600 in Commercial.</li>
            <li>Client have to handle the local issues.</li>
            </ul>
            <li>This price valid for 7 days of date issue.</li>
            <li>MOST IMP solar system will supply & install as per the DISCOM Feasibility Approved.</li>
        </ol>
    </div>
</body>
</html>


<!-- <tr>
    <td></td>
    <td></td>
</tr> -->
